var ASB=(function(l,h){function d(a,m){if(!h("#"+a).length){return}this.options={rate:10,shuffle:false,fadeRate:400,size:100,maxWidth:0,maxHeight:0,maintainHeight:1};h.extend(this.options,m||{});this.startHeight=this.options.size;if(this.options.maxHeight>0&&this.options.maintainHeight){this.startHeight=this.options.maxHeight}this.container=h("#"+a);this.container.css({width:this.options.size+"px",height:this.startHeight+"px",marginLeft:"auto",marginRight:"auto",position:"relative"});if(typeof this.options.images==="undefined"||this.options.images.length==0){return}this.current=0;if(this.options.shuffle){this.options.images.sort(function(){return 0.5-Math.random()})}this.mainImage=h("<img/>",{src:this.getCurrentImage()}).css({display:"none",position:"absolute",left:"0px",top:"0px"});this.container.append(this.mainImage);this.bufferImage=this.mainImage.clone();this.container.append(this.bufferImage);this.cloneWidth=this.cloneHeight=0;this.showCurrent();h(h.proxy(this.run,this));h(window).unload(h.proxy(this.stop,this))}function g(){this.timeOutId=setTimeout(h.proxy(this.showNext,this),this.options.rate*1000)}function j(){clearTimeout(this.timeOutId)}function b(){return this.options.folder?this.options.folder+"/"+this.options.images[this.current]:this.options.images[this.current]}function f(){this.bufferImage.prop("title",this.mainImage.prop("title"));this.bufferImage.prop("alt",this.mainImage.prop("alt"));this.bufferImage.prop("src",this.mainImage.prop("src"));this.resizeImage(this.bufferImage).show();this.mainImage.hide();this.current++;if(this.options.images.length<=this.current){this.current=0}}function i(){this.mainImage.prop("title",this.options.images[this.current]);this.mainImage.prop("alt",this.options.images[this.current]);this.mainImage.prop("src",this.getCurrentImage());this.clone=h("<img/>",{src:this.mainImage.prop("src")}).css({position:"absolute",display:"block"});h("body").append(this.clone);this.clone.load(h.proxy(this.resize,this)).each(function(){if(this.complete){h(this).load()}});h(this.mainImage).fadeIn(this.options.fadeRate);if(this.running){h(this.bufferImage).fadeOut(this.options.fadeRate)}this.running=true}function c(o){var a=this.clone.height(),n=this.clone.width(),m;if(a>n){m=a/n;this.cloneWidth=parseInt(this.options.size/m);this.cloneHeight=this.options.size;if(this.options.maxWidth>0&&this.cloneWidth>this.options.maxWidth){this.cloneWidth=this.options.maxWidth;this.cloneHeight=parseInt(this.options.maxWidth*m)}if(this.options.maxHeight>0&&this.cloneHeight>this.options.maxHeight){this.cloneWidth=parseInt(this.options.maxHeight/m);this.cloneHeight=this.options.maxHeight}}else{if(n>a){m=n/a;this.cloneWidth=this.options.size;this.cloneHeight=parseInt(this.options.size/m);if(this.options.maxWidth>0&&this.cloneWidth>this.options.maxWidth){this.cloneWidth=this.options.maxWidth;this.cloneHeight=parseInt(this.options.maxWidth/m)}if(this.options.maxHeight>0&&this.cloneHeight>this.options.maxHeight){this.cloneWidth=parseInt(this.options.maxHeight*m);this.cloneHeight=this.options.maxHeight}}else{this.cloneHeight=this.cloneWidth=this.options.size;if(this.options.maxWidth>0&&this.cloneWidth>this.options.maxWidth){this.cloneHeight=this.cloneWidth=this.options.maxWidth}if(this.options.maxHeight>0&&this.cloneHeight>this.options.maxHeight){this.cloneWidth=this.cloneHeight=this.options.maxHeight}}}this.clone.remove();this.resizeImage(this.mainImage)}function k(a){style={height:this.cloneHeight+"px",width:this.cloneWidth+"px",left:parseInt((this.options.size/2)-(this.cloneWidth/2))+"px",top:parseInt((this.startHeight/2)-(this.cloneHeight/2))+"px"};if(!this.options.maintainHeight){this.container.css("height",this.cloneHeight+"px");style.top="0px"}a.css(style);return a}function e(){if(this.container.width()>0){this.nextImage();this.showCurrent()}this.run()}d.prototype={run:g,stop:j,showCurrent:i,getCurrentImage:b,nextImage:f,showNext:e,resize:c,resizeImage:k};l.modules=h.extend({Slideshow:d},l.modules||{});return l})(ASB||{},jQuery);